export const metadata = { title: "Better Auth" };

import { CodeGroup, ContentByFramework } from "@/components/forMdx";

# Better Auth

Jazz can be integrated with [Better Auth](https://www.better-auth.com/) to provide authentication methods to users. This integration allows users to sign up or sign in through your Jazz application, using authentication infrastructure managed by you.

## How it works

When using Better Auth, users:

1. Sign up or sign in through your Jazz application.
2. Your application's authentication server stores the user's account keys and provides a traditional authentication experience.
3. When logging in, Jazz retrieves the user's account keys from your authentication server.
4. Users can work offline with full Jazz functionality.

This authentication method is not fully local-first, as it relies on a connection to your authentication server to authenticate and retrieve account keys.

## Key benefits

- **Hosted on your infrastructure**: Secret management and control over user data becomes your responsibility.
- **Many authentication methods**: Adding support for email & password and OAuth providers is straightforward.
- **User-friendly**: Standard authentication flows users already know.

## Implementation

<ContentByFramework framework="vanilla">
We offer Better Auth integration through our package: [`jazz-auth-betterauth`](https://npmjs.com/package/jazz-auth-betterauth).

The package provides a `BetterAuth` object for managing authentication state.

For documentation on how to configure Better Auth clients created via `createAuthClient`, read the [Better Auth documentation](https://www.better-auth.com/docs/introduction).

<CodeGroup>
```tsx twoslash
const authUrl: string = "http://localhost:3000/api/auth/";
const userName: string = "Firstname Lastname";
const userEmail: string = "user@example.com";
const userPassword: string = "12345678";
const authenticate = async () => {};
import { AuthSecretStorage } from "jazz-tools";
const authSecretStorage = new AuthSecretStorage();
// ---cut---
import { BetterAuth } from "jazz-auth-betterauth";
import { createAuthClient } from "better-auth/client";
import { jazzClientPlugin } from "jazz-betterauth-client-plugin";
// @annotate: Creating the authentication client.

const auth = new BetterAuth(authenticate, authSecretStorage, createAuthClient({ baseURL: authUrl, plugins: [jazzClientPlugin()] }));
// @annotate: Signing up with email & password

await auth.authClient.signUp.email({
  name: userName,
  email: userEmail,
  password: userPassword,
}, {
  onSuccess: async () => {
    await auth.signIn();
  }
});
// @annotate: Signing in with email & password

await auth.authClient.signIn.email({
  email: userEmail,
  password: userPassword
}, {
  onSuccess: async () => {
    await auth.logIn();
  }
});
```

</CodeGroup>
</ContentByFramework>

<ContentByFramework framework="react">
We offer Better Auth integration through our package: [`jazz-react-auth-betterauth`](https://npmjs.com/package/jazz-react-auth-betterauth).

The package provides a `useBetterAuth` hook for managing authentication state.

For documentation on how to configure Better Auth clients created via `useBetterAuth`, read the [Better Auth documentation](https://www.better-auth.com/docs/introduction).

<CodeGroup>
```tsx twoslash
import * as React from "react";
const authUrl: string = "https://auth.jazz.tools/exampleApiKey/api/auth/";
const userName: string = "Firstname Lastname";
const userEmail: string = "user@example.com";
const userPassword: string = "12345678";
// ---cut---
import { useBetterAuth } from "jazz-react-auth-betterauth";
import { createAuthClient } from "better-auth/client";
import { jazzClientPlugin } from "jazz-betterauth-client-plugin";
// @annotate: Creating the authentication client.

const auth = useBetterAuth(createAuthClient({ baseURL: authUrl, plugins: [jazzClientPlugin()] }));
// @annotate: Signing up with email & password

await auth.authClient.signUp.email({
  name: userName,
  email: userEmail,
  password: userPassword,
}, {
  onSuccess: async () => {
    await auth.signIn();
  }
});
// @annotate: Signing in with email & password

await auth.authClient.signIn.email({
  email: userEmail,
  password: userPassword
}, {
  onSuccess: async () => {
    await auth.logIn();
  }
});
```

</CodeGroup>
</ContentByFramework>

<ContentByFramework framework="react-native-expo">
See [the Better Auth documentation on adding Expo support to your client & server](https://www.better-auth.com/docs/integrations/expo).

We offer Better Auth integration through our package: [`jazz-react-auth-betterauth`](https://npmjs.com/package/jazz-react-auth-betterauth).

The package provides a `useBetterAuth` hook for managing authentication state.

For documentation on how to configure Better Auth clients created via `useBetterAuth`, read the [Better Auth documentation](https://www.better-auth.com/docs/introduction).

<CodeGroup>
```tsx twoslash
import * as React from "react";
const authUrl: string = "https://auth.jazz.tools/exampleApiKey/api/auth/";
const userName: string = "Firstname Lastname";
const userEmail: string = "user@example.com";
const userPassword: string = "12345678";
const appScheme: string = "myapp";
const appStoragePrefix: string = "myapp";
// ---cut---
import { expoClient } from "@better-auth/expo/client";
import * as SecureStore from "expo-secure-store";
import { useBetterAuth } from "jazz-react-auth-betterauth";
import { createAuthClient } from "better-auth/client";
import { jazzClientPlugin } from "jazz-betterauth-client-plugin";
// @annotate: Creating the authentication client.

const auth = useBetterAuth(createAuthClient({
  baseURL: authUrl,
  plugins: [
    jazzClientPlugin(),
    expoClient({
        scheme: appScheme,
        storagePrefix: appStoragePrefix,
        storage: SecureStore,
    })
  ]
}));
// @annotate: Signing up with email & password

await auth.authClient.signUp.email({
  name: userName,
  email: userEmail,
  password: userPassword,
}, {
  onSuccess: async () => {
    await auth.signIn();
  }
});
// @annotate: Signing in with email & password

await auth.authClient.signIn.email({
  email: userEmail,
  password: userPassword
}, {
  onSuccess: async () => {
    await auth.logIn();
  }
});
```

</CodeGroup>
</ContentByFramework>

## Examples

You can explore Jazz applications using Better Auth in our [example projects](/docs/examples).

## When to use Better Auth

Better Auth is appropriate when:

- You want a traditional & seamless authentication experience for your users.
- You want control over your application's authentication infrastructure.
- Your application would benefit from email & password authentication, with password resets and email verification.
- Your application would benefit from social sign-on, such as through Google or GitHub.
- You want to avoid users managing their own account keys.
- You want to configure your authentication server's hooks, database, and methods.

## Limitations and considerations

- **Online requirement**: Internet connectivity is required when authenticating.
- **Third-party dependency**: Your authentication server will depend on the Better Auth library.
- **Platform support**: Adding support for Expo applications is your responsibility.
- **Configuration**: You will need to configure your authentication methods, server framework, and database.

## Additional resources

- [Better Auth documentation](https://www.better-auth.com/docs/introduction)
